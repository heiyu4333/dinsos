<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <meta name="theme-color" content="#121212" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
  <link rel="apple-touch-icon" href="icons/icon-192.png" />
  <link rel="manifest" href="manifest.webmanifest" />
  <link rel="stylesheet" href="styles.css" />
  <title>Pendataan Penduduk</title>
</head>
<body>
  <header class="app-header">
    <div class="header-left">
      <h1>Pendataan Penduduk</h1>
    </div>
    <div class="header-right">
      <span id="netStatus" class="net-status offline" title="Status koneksi">Offline</span>
      <button id="themeToggle" class="btn secondary">Tema</button>
      <button id="installBtn" class="btn secondary" disabled hidden>Install</button>
    </div>
  </header>

  <main class="container">
    <section id="view-household" class="view active">
      <h2>Formulir Rumah Tangga</h2>
      <form id="householdForm" novalidate>
        <div class="form-group">
          <label>Nama Kepala Rumah Tangga</label>
          <input type="text" id="headName" required />
        </div>
        <div class="form-group">
          <label>No. yang bisa dihubungi</label>
          <input type="tel" id="phone" required placeholder="contoh: +6281234567890" />
        </div>
        <div class="form-group">
          <label>Alamat</label>
          <textarea id="address" required></textarea>
        </div>
        <div class="form-grid">
          <div class="form-group">
            <label>Kelurahan/Desa</label>
            <input type="text" id="kelurahan" required />
          </div>
          <div class="form-group">
            <label>Kecamatan</label>
            <input type="text" id="kecamatan" required />
          </div>
        </div>
        <div class="form-grid">
          <div class="form-group">
            <label>Kondisi Rumah</label>
            <select id="homeCondition" required>
              <option value="">Pilih</option>
              <option>Mewah</option>
              <option>Baik</option>
              <option>Sederhana</option>
              <option>Buruk</option>
              <option>Amat Buruk</option>
            </select>
          </div>
          <div class="form-group">
            <label>Kepemilikan Rumah</label>
            <select id="ownership" required>
              <option value="">Pilih</option>
              <option>Milik Sendiri</option>
              <option>Sewa/Kontrak</option>
              <option>Numpang</option>
            </select>
          </div>
        </div>
        <div class="form-group">
          <label>Foto Rumah</label>
          <input type="file" id="housePhoto" accept="image/*" />
          <div class="image-preview">
            <img id="housePhotoPreview" alt="Preview Foto" />
          </div>
        </div>
        <div class="form-group">
          <label>Keterangan tambahan (opsional)</label>
          <textarea id="houseNotes"></textarea>
        </div>
        <div class="actions">
          <button type="submit" class="btn primary">Simpan</button>
        </div>
      </form>
    </section>

    <section id="view-kk" class="view">
      <h2>Formulir Kartu Keluarga</h2>
      <form id="kkForm" novalidate>
        <div class="form-grid">
          <div class="form-group">
            <label>Nomor Kartu Keluarga</label>
            <input type="text" id="kkNumber" required placeholder="16 digit" />
          </div>
          <div class="form-group">
            <label>Jumlah Anggota Keluarga</label>
            <input type="number" id="memberTotal" min="1" required />
          </div>
        </div>
        <div class="actions">
          <button type="submit" class="btn primary">Tambah Kartu Keluarga</button>
        </div>
      </form>

      <div class="kk-list" id="kkList"></div>

      <div class="kk-select">
        <label>Pilih KK untuk isi anggota</label>
        <select id="kkSelect"></select>
        <div class="actions">
          <button id="goMembersBtn" class="btn primary">Data Anggota Keluarga</button>
        </div>
      </div>
    </section>

    <section id="view-members" class="view">
      <h2>Formulir Anggota Keluarga</h2>
      <div class="kk-header">
        <span>Nomor KK: </span><strong id="selectedKKHeader"></strong>
      </div>
      <form id="memberForm" novalidate>
        <div class="form-group">
          <label>Nama</label>
          <input type="text" id="memberName" required />
        </div>
        <div class="form-group">
          <label>NIK</label>
          <input type="text" id="memberNIK" required placeholder="16 digit" />
        </div>
        <div class="form-grid">
          <div class="form-group">
            <label>Hubungan Keluarga</label>
            <select id="relation" required>
              <option value="">Pilih</option>
              <option>Ayah</option>
              <option>Ibu</option>
              <option>Anak</option>
              <option>Lainnya</option>
            </select>
          </div>
          <div class="form-group">
            <label>Kesehatan</label>
            <div class="radio-group">
              <label><input type="radio" name="health" value="Normal" checked /> Normal</label>
              <label><input type="radio" name="health" value="Disabilitas" /> Disabilitas</label>
            </div>
          </div>
        </div>
        <div class="form-grid">
          <div class="form-group">
            <label>Pendidikan</label>
            <select id="education" required>
              <option value="">Pilih</option>
              <option>Tidak Sekolah</option>
              <option>SD</option>
              <option>SMP</option>
              <option>SMA/SMK</option>
              <option>D1</option>
              <option>D2</option>
              <option>D3</option>
              <option>S1</option>
              <option>S2</option>
              <option>S3</option>
            </select>
          </div>
          <div class="form-group">
            <label>Pekerjaan</label>
            <input type="text" id="job" required />
          </div>
        </div>
        <div class="form-grid">
          <div class="form-group">
            <label>Tempat Lahir</label>
            <input type="text" id="birthPlace" required />
          </div>
          <div class="form-group">
            <label>Tanggal Lahir</label>
            <input type="date" id="birthDate" required />
          </div>
        </div>
        <div class="form-group">
          <label>Keterangan Tambahan (opsional)</label>
          <textarea id="memberNotes"></textarea>
        </div>
        <div class="actions">
          <button type="submit" class="btn primary">Simpan</button>
        </div>
      </form>

      <div id="memberList" class="member-list"></div>
    </section>

    <section id="view-summary" class="view">
      <h2>Ringkasan</h2>
      <div id="summaryHousehold" class="summary-card"></div>
      <div id="summaryKKs" class="summary-list"></div>
      <div class="actions">
        <button id="editDataBtn" class="btn secondary">Edit</button>
        <button id="exportPdfBtn" class="btn primary">Simpan PDF</button>
      </div>
    </section>
  </main>

  <nav class="bottom-nav" role="navigation" aria-label="Navigasi bawah">
    <button class="nav-item active" data-target="view-household" aria-label="Rumah Tangga">
      <span class="icon" aria-hidden="true">
        <svg viewBox="0 0 24 24" width="24" height="24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <path d="M3 10.5l9-7 9 7"/> 
          <path d="M5 10v9a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2v-9"/>
          <path d="M9 21V12h6v9"/>
        </svg>
      </span>
      <span class="label">Rumah</span>
    </button>
    <button class="nav-item" data-target="view-kk" aria-label="Kartu Keluarga">
      <span class="icon" aria-hidden="true">
        <svg viewBox="0 0 24 24" width="24" height="24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <rect x="3" y="5" width="18" height="14" rx="2"/>
          <path d="M7 9h10"/>
          <path d="M7 13h6"/>
        </svg>
      </span>
      <span class="label">KK</span>
    </button>
    <button class="nav-item" data-target="view-members" aria-label="Anggota Keluarga">
      <span class="icon" aria-hidden="true">
        <svg viewBox="0 0 24 24" width="24" height="24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <circle cx="8" cy="8" r="3"/>
          <circle cx="16" cy="8" r="3"/>
          <path d="M2 20a6 6 0 0 1 12 0"/>
          <path d="M10 20a6 6 0 0 1 12 0"/>
        </svg>
      </span>
      <span class="label">Anggota</span>
    </button>
    <button class="nav-item" data-target="view-summary" aria-label="Ringkasan">
      <span class="icon" aria-hidden="true">
        <svg viewBox="0 0 24 24" width="24" height="24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <rect x="3" y="3" width="14" height="18" rx="2"/>
          <path d="M7 8h6"/>
          <path d="M7 12h6"/>
          <path d="M7 16h6"/>
        </svg>
      </span>
      <span class="label">Ringkas</span>
    </button>
  </nav>

  <div id="toast" class="toast" role="status" aria-live="polite"></div>

  <script src="https://cdn.jsdelivr.net/npm/jspdf@2.5.1/dist/jspdf.umd.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/jspdf-autotable@3.8.2/dist/jspdf.plugin.autotable.min.js"></script>
  <script src="app.js" defer></script>
  <script>
    if ('serviceWorker' in navigator) {
      window.addEventListener('load', function() {
        navigator.serviceWorker.register('service-worker.js');
      });
    }
  </script>
</body>
</html>
